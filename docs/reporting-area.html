
<!DOCTYPE html>
<html>
  <head>
    <title>Exactius reporting area</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TVRZX55');</script>
    <!-- End Google Tag Manager -->


    <script>
    </script>
  </head>

  <body>
    <h1>Exactius reporting area! <small>gtm, jq, bootstrap</small></h1>
    in reporting area:


  <br>
  <button id="lp-pom-button-182" >pricing-daily</button>
  <br>
  <button id="lp-pom-button-181" >pricing-monthly</button>
  <br>
  <button id="lp-pom-button-99" >testimonial-vet</button>
  <br>
  <button id="lp-pom-button-98" >testimonial-parent</button>
  <br>
  <button id="lp-pom-button-279" >dog | header</button>
  <br>
  <button id="lp-pom-button-326" >cat | header</button>
  <br>
  <button id="lp-pom-button-184" >get quote | pricing card</button>
  <br>
  <button id="lp-pom-button-87" >get quote | coverage overview</button>
  <br>
  <button id="lp-pom-button-160" >get quote | save on preventive care</button>
  <br>
  <button id="lp-pom-button-166" >get quote | 90 percent reimbursement</button>
  <br>
  <button id="lp-pom-button-418" >get quote | savings add up</button>
  <br>
  <button id="lp-pom-button-47" >create my pet plan | hero</button>
  <br>
  <button id="lp-pom-button-251" >see what you get | wizard</button>
  <br>
  <button id="lp-pom-button-554" >restart | wizard</button>
  <br>
  <button id="lp-pom-button-90" >see why pet owners | try 30 days free</button>
  <br>
  <button id="lp-pom-button-137" >How Pumpkin makes life easier | make it easy</button>
  <br>
  <button id="lp-pom-button-472" >Add another pet | under pricing</button>
  <br>
  <button id="lp-pom-button-46" >hero</button>
  <br>
  <button id="lp-pom-image-545" >makes life easier</button>
  <br>
  <button id="lp-pom-box-34" >one | popup</button>
  <br>
  <button id="lp-pom-box-37" >more than one | popup</button>
  <br>
  <button id="lp-pom-box-565" >one</button>
  <br>
  <button id="lp-pom-box-568" >more than one</button>
  <br>
  <button id="lp-pom-box-241" >dog</button>
  <br>
  <button id="lp-pom-box-242" >cat</button>
  <br>
  <button id="lp-pom-box-254" >male</button>
  <br>
  <button id="lp-pom-box-257" >female</button>
  <br>
  <button id="lp-pom-box-595" >yes</button>
  <br>
  <button id="lp-pom-box-598" >no</button>
  <br>
  <button id="lp-pom-box-584" >yes-currently</button>
  <br>
  <button id="lp-pom-box-587" >yes-previously</button>
  <br>
  <button id="lp-pom-box-591" >no</button>
  <br>
  <button id="lp-pom-button-53" ></button>
  <br>
  <button id="lp-pom-image-751" >Software Engineering</button>
  <br>
  <button id="lp-pom-image-750" >UX/UI Design</button>

  <h1>Circa testing</h1>
  <br>
  <select id="lp-cir-dropdown-182">
  	<option value="us-en">US-EN</option>
  	<option value="es">ES</option>
  	<option value="ch">CHN</option>
  </select>
  <br>
  <button id="lp-cir-button-181" >phone-button</button>
  <br>
  <button id="lp-cir-button-99" >chat-button</button>
  <br>
  <button id="lp-cir-button-98" >navbar-cta-button</button>
  <br>
  <button id="lp-cir-button-279" >hero-cta-button</button>
  <br>
  <select id="lp-cir-dropdown-326">
  	<option value="new_york">New York</option>
  	<option value="chicago">Chicago</option>
  	<option value="madrid">Madrid</option>
  	<option value="bethesda">Bethesda</option>
  	<option value="hong_kong">Hong Kong</option>
  </select>
  <br>
  <select id="lp-cir-dropdown-184">
  	<option value="2020-01-01">1/1/2020</option>
  	<option value="2020-02-01">2/1/2020</option>
  	<option value="2020-03-10">3/10/2020</option>
  	<option value="2020-04-14">4/14/2020</option>
  </select>
  <br>
  <select id="lp-cir-dropdown-87">
  	<option value="09:30:00">9:30 AM</option>
  	<option value="11:00:00">11:00 AM</option>
  	<option value="15:30:00">3:30 PM</option>
  	<option value="19:00:00">7:00 PM</option>
  </select>
  <br>
  <select id="lp-cir-dropdown-160">
  	<option value="1-5_pieces">1-5 Pieces</option>
  	<option value="6-10_pieces">6-10 Pieces</option>
	<option value=">10_pieces">11+ Pieces</option>
  </select>
  <br>
  <button id="lp-cir-button-166" >phone-number-footer</button>
  <br>
  <button id="lp-cir-button-418" >phone-number-more-info</button>
  <br>
  <button id="lp-cir-button-47" >phone-number-confirmation</button>
  <br>
  <button id="lp-cir-button-251" >directions-new-york</button>
  <br>
  <button id="lp-cir-button-554" >directions-hong-kong</button>
  <br>
  <button id="lp-cir-button-90" >social-twitter</button>
  <br>
  <button id="lp-cir-button-137" >social-facebook</button>
  <br>
  <button id="lp-cir-button-472" >faq-what-do-you-buy</button>
  <br>
  <button id="lp-cir-button-46" >faq-how-does-it-work</button>
  <br>
  <h2>Ilya's dubugging</h2>
  ClientId <input type="text" value="" id="js-fields-clientId"/><br/>
  Datetime <input type="text" value="" id="js-app-datetime"/><br/>
  firstName <input type="text" value="Bob" id="js-app-firstName"/><br/>
  lastName <input type="text" value="Marley" id="js-app-lastName"/><br/>
  phone <input type="text" value="112233445566" id="js-app-phone"/><br/>
  email <input type="text" value="bob@marley.com" id="js-app-email"/><br/>
  <button id="demo-create-appointment">Create Appointment</button>
  <br>
  <br><br><br><br><br>

  </body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TVRZX55"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <script>
    (async function() {
      const endpoint = 'https://09wpk27ysj.execute-api.us-west-1.amazonaws.com/prod';
      setTimeout(populateClientId, 1000);
      await fetchAvailableDate()
      document.querySelector('#demo-create-appointment').addEventListener('click', createAppointment);


      function populateClientId() {
        document.querySelector('#js-fields-clientId').value = ga.getAll()[0].get('clientId');
      }
      
      async function fetchAvailableDate() {
        date = new Date();
        const today = date.getFullYear()+'-' + (date.getMonth()+1) + '-'+date.getDate();
        const query = `availability/times?date=${today}&appointmentTypeID=9912406`;
        const url = `${endpoint}/${query}`;
        const times = await fetch(url).then(data => data.json());
        document.querySelector('#js-app-datetime').value = times[0].time;
      }

      async function createAppointment() {
        const payload = {
          "owner": 17607485,
          "isIntegratedSquarespace": false,
          "linkAppointmentType": null,
          "linkCalendar": "3184393",
          "appointmentType": 9912406,
          "calendar": 3184393,
          "datetime": "2019-12-25T01:00:00-0500",
          "firstName": "Ilya",
          "appointmentTypeID": "9912406",
          "lastName": "Libin",
          "phone": "+10542107088",
          "email": "libin.ilya@gmail.com",
          "fields": [
            {
              "id": 6282061,
              "value": "Selling Test Test"
            },
            {
              "id": 6372527,
              "value": "1-5 Pieces"
            },
            {
              "id": 7059843,
              "value": "dummy-clientId"
            },
            {
              "id": 6815613,
              "value": "REFERRAL CAMPAIGN"
            },
            {
              "id": 6707893,
              "value": "REFERRAL SOURCE"
            }
          ],
          "pay_later": 1
        }

        document.querySelectorAll("[id^='js-app']").forEach($item => {
          const field = $item.id.split('-').pop();
          payload[field] = $item.value;
        })
  
        payload.fields = payload.fields.map(item => {
          if(item.id === 7059843) {
            item.value = document.querySelector('#js-fields-clientId').value;
            return item;
          } else {
            return item;
          }
        })
  
        const response = await fetch(`${endpoint}/appointments`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(payload)
        }).then(data => data.json());
        alert(JSON.stringify(response));
      }
    })()
  </script>
</html>
